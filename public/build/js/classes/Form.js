import UI from"./UI.js";const ui=new UI,mistakes={vacio:[],formatWrong:!1,yearWrong:!1,cvcWrong:!1};export default class Form{constructor(){}sendForm(){const e=document.querySelector(".form"),t=document.querySelectorAll(".input"),a=document.querySelector("#number");e.addEventListener("submit",(e=>{e.preventDefault();for(let e of t)this.validateInput(e);this.validateNumber(a),0===mistakes.vacio.length&&!1===mistakes.formatWrong&&!1===mistakes.yearWrong&&!1===mistakes.cvcWrong&&ui.successCode()}))}inputVacios(){const e=document.querySelectorAll(".input");for(let t of e)t.addEventListener("keyup",(()=>{this.validateInput(t)}))}cardNumber(){document.querySelector("#number").addEventListener("keyup",(e=>{e.target.value&&"Backspace"!==e.key&&(e.target.value=ui.formatearNumero(e.target.value)),this.validateNumber(e.target)}))}validateInput(e){if(""===e.value){let t="Can't be blank";const a=ui.imprimirAlerta(t,e);return ui.resetDataCard(e),void(a&&mistakes.vacio.push(e.name))}let t=mistakes.vacio.filter((t=>t!==e.name));mistakes.vacio=[...t],ui.realTimeCard(e),"year"!==e.id&&"cvc"!==e.id&&ui.limpiarAlerta(e)}validateNumber(e){let t=e.value,a=0;for(let r=0;r<t.length;r++)if(parseInt(t[r])||" "===t[r]||"0"===t[r]){if(t.length<19){let t="Wrong format";const r=ui.imprimirAlerta(t,e);a++,mistakes.formatWrong=r}}else{let t="Wrong format, numbers only";const r=ui.imprimirAlerta(t,e);a++,mistakes.formatWrong=r}0===a&&mistakes.formatWrong&&(mistakes.formatWrong=!1)}validateDate(e){let t=(new Date).getFullYear().toString();t=`${t[2]}${t[3]}`;let a=parseInt(t)-5,r=parseInt(t)+5;if(e.value<a||e.value>r){let t="Year wrong";return ui.imprimirAlerta(t,e),void(mistakes.yearWrong=!0)}mistakes.yearWrong=!1,ui.limpiarAlerta(e)}validateCVC(){document.querySelector("#cvc").addEventListener("keyup",(e=>{if(e.target.value.length<=2){let t="CVC wrong";return ui.imprimirAlerta(t,e.target),void(mistakes.cvcWrong=!0)}ui.limpiarAlerta(e.target),mistakes.cvcWrong=!1}))}dateFormat(){const e=document.querySelector("#date"),t=document.querySelector("#year");e.addEventListener("keydown",(e=>{if("Backspace"!==e.key){let t=e.target;t.value=ui.addZero(t.value),t.value.length>1&&"1"===t.value[1]&&parseInt(e.key)<3&&(t.value=ui.formatDate(t.value,e.key))}"Backspace"===e.key&&(e.target.value="")})),t.addEventListener("keydown",(e=>{if("Backspace"!==e.key){let t=e.target;t.value=ui.addZero(t.value),t.value.length>1&&"0"===t.value[0]&&(t.value=ui.formatDate(t.value,e.key)),this.validateDate(t)}"Backspace"===e.key&&(e.target.value="")}))}}